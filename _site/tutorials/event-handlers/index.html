<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>T3 Javascript Framework - Tutorials</title>

        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" href="/pages/Box/T3/css/base.css">
        <link rel="stylesheet" href="/pages/Box/T3/css/skeleton.css">
        <link rel="stylesheet" href="/pages/Box/T3/css/layout.css">

        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/pages/Box/T3/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/pages/Box/T3/css/main.css">

    </head>


    <body>

        <header class="header">
    <div class="container">
        <div class="sixteen columns">
            <nav class="header-nav">
                <ul>
    <li class="">
        <a href="/pages/Box/T3/">overview</a>
    </li>
    <li class="">
        <a href="/pages/Box/T3/documentation">documentation</a>
    </li>
    <li class="current">
        <a href="/pages/Box/T3/tutorials">tutorials</a>
    </li>
    <li class="">
        <a href="/pages/Box/T3/download">download</a>
    </li>
    <li class="">
        <a href="/pages/Box/T3/examples">examples</a>
    </li>
</ul>
            </nav>
        </div>
    </div>
</header>
<div class="header-spacer"></div>


        <div class="content container">
            <div class="three columns">
                <div>
  <aside>
    <h4><a href="/pages/Box/T3/tutorials/">Tutorial</a></h4>
    <ul>
        <li>Initial Setup</li>
        <li>Create a Module</li>
        <li>Passing Messages</li>
        <li>Event Handlers</li>
        <li>Use a Service</li>
        <li>Add Widgets</li>
        <li>Firing Custom Events</li>
        <li>Use Custom Data</li>
        <li>Add a Behavior</li>
    </ul>
  </aside>
</div>
            </div>
            <div class="tutorial twelve columns offset-by-one">
                <h1>Event Handlers</h1>

<p>Now that we have two modules on the page that can communicate with each other, there is only one missing link: communication with the user. User-triggered events are handled by the T3 framework and events are delegated to the nearest ancestor DOM node that is a T3 module. In the framework there are methods similar to <code>onmessage</code> that are for DOM events, they are all prefixed with <code>on</code> and prepended with the standard DOM event names. For example, T3 modules that want to handle click events simply have to implement an <code>onclick</code> function on their public interface. These functions will pass the triggered event, the module element, and the <code>data-type</code> attribute from the target element of the event (more on this in a moment). With these sources of information we will be able to capture any event, have the module do it&#39;s thing, and broadcast the event in the case that anybody else cared this happen (they won&#39;t know since this it&#39;s not their module element scope).</p>

<h2>Using Events</h2>

<p>Let&#39;s handle some events in our application. For now what we want to do is capture the <code>keyup</code> event that is triggered on the input fields, take the changed value, and do the same broadcast we are in <code>meme-menu.init</code>. First we will have to add the public interface method that will handle the <code>keyup</code> event, it&#39;ll look something like below:</p>

<div class="highlight"><pre><code class="javascript"><span class="k">return</span> <span class="p">{</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{...},</span>
  <span class="nx">onclick</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{...},</span>
  <span class="nx">onmessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{...},</span>
  <span class="nx">onkeyup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">elementType</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// We&#39;ll do our magic in here</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<p>This <code>onkeyup</code> event won&#39;t get triggered with enough data (which input field), we will have to decorate the HTML elements with the <code>data-type</code> attribute and that will populate the <code>elementType</code> parameter. The HTML for the <code>&lt;input&gt;</code>s is simple:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;bottom-text-input&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-type=</span><span class="s">&quot;top-input&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;top-text-input&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-type=</span><span class="s">&quot;bottom-input&quot;</span><span class="nt">&gt;</span>
</code></pre></div>

<p>Now implementing <code>onkeyup</code> is straightforward, we will extract the data from the target element from the event and get the label we should update — the broadcast will remain the same as before.</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">onkeyup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">elementType</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">direction</span> <span class="o">=</span> <span class="nx">elementType</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-input&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
      <span class="nx">value</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

  <span class="nx">Application</span><span class="p">.</span><span class="nx">broadcast</span><span class="p">(</span><span class="s1">&#39;memetextchanged&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="nx">value</span><span class="p">,</span>
    <span class="nx">direction</span><span class="o">:</span> <span class="nx">direction</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<p>Excellent! When we type we should see the overlay text labels get updated whenever a key is pressed in one of the input fields.</p>

<h2>Exercise</h2>

<p>That was fun, right? Now it&#39;s your turn! Let&#39;s synthesize all the concepts we learned in the T3 framework and do some magic.</p>

<p>The exercise is to update the meme&#39;s image when one of the thumbnails are clicked. You can check out which the images that are available in the <code>img/full/</code> directory. This should encompass creating a new message that is broadcasted and event handling. Have it at and we&#39;ll meet up again at the next step!</p>


                
                  <a class="prev" href="/pages/Box/T3/tutorials/passing-messages">← Passing Messages</a>
                

                
                  <a class="next" href="/pages/Box/T3/tutorials/use-a-service">Use a Service →</a>
                
            </div>
        </div>

        <footer class="footer">
    <div class="container">
        <div class="sixteen columns">
            <p>&copy; 2014 Box.com, Inc.</p>
        </div>
    </div>
</footer>


    </body>

</html>

